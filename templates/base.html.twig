{% set menus = menu_service.findAll %}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>TechnoLogin - {% block title %}{% endblock %}</title>
    <link rel="icon"
          href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text></svg>">
    {# Run `composer require symfony/webpack-encore-bundle` to start using Symfony UX #}
    {% block stylesheets %}
        {{ encore_entry_link_tags('Bulma') }}
    {% endblock %}

    {% block javascripts %}
        {{ encore_entry_script_tags('app') }}
    {% endblock %}
</head>
<body>
{% if is_granted('ROLE_AUTHOR') %}
<nav class="py-2 has-background-black has-text-white-ter">
    <div class="is-flex flex-wrap justify-between container navbar-start" style="z-index: 100;">
        <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
                Mon Blog
            </a>
            <ul class="navbar-dropdown">
                <li><a class="navbar-item" href="{{ path('admin') }}">Tableau de bord</a></li>
                {% if is_granted('ROLE_ADMIN') %}
                <li><a class="navbar-item" href="{{ ea_index('MenuCrudController') }}">Menus</a></li>
                {% endif %}
            </ul>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
                Ajouter
            </a>
            <ul class="navbar-dropdown">
                <li><a class="navbar-item" href="#">Article</a></li>
                <li><a class="navbar-item" href="#">Page</a></li>
            </ul>
        </div>

    </div>
</nav>
{% endif %}

<div class="box">
    <div class="container">
        <nav class="navbar" role="navigation" aria-label="main navigation">
            <div class="navbar-start">
                <a href="{{ path('app_home') }}"
                   class="navbar-item">
                    <h1 class="title is-1">TechnoLogin</h1>
                </a>
            </div>

            <ul class="navbar-end">
                {% for menu in menus %}
                    {% if menu.subMenus.count > 0 %}
                        <li class="navbar-item has-dropdown is-hoverable">
                            <a class="navbar-link" href="#">
                                {{ menu.name }}
                            </a>
                            <ul class="navbar-dropdown">
                                {% for subMenu in menu.subMenus %}
                                    <li><a class="navbar-item" href="{{ subMenu|menuLink }}">{{ subMenu.name }}</a></li>
                                {% endfor %}
                            </ul>
                        </li>
                    {% else %}
                        <li class="navbar-item">
                            <a href="{{ menu|menuLink }}">
                                {{ menu.name }}
                            </a>
                        </li>
                    {% endif %}
                {% endfor %}
                <div class="navbar-item">
                    {% if not is_granted('IS_AUTHENTICATED_FULLY') %}
                        <div class="buttons">
                            <a class="button is-primary" href="{{ path('app_login') }}">
                                <strong>Connexion</strong>
                            </a>
                            <a class="button is-light" href="{{ path('app_register') }}">
                                Inscription
                            </a>
                        </div>
                    {% else %}
                        <div class="navbar-item has-dropdown is-hoverable">
                            <a class="navbar-link">
                                {{ app.user.username|capitalize }}
                            </a>
                            <ul class="navbar-dropdown">
                                <li><a class="navbar-item" href="{{ path('user_profile', {'username': app.user.username}) }}">Profil</a></li>
                                <li><a class="navbar-item" href="{{ path('app_logout') }}">Déconnexion</a></li>
                            </ul>
                        </div>
                    {% endif %}
                </div>
            </ul>
        </nav>
    </div>
</div>
{% block body %}{% endblock %}
<footer class="footer">
    <div class="content has-text-centered">
        <p>
            © {{ 'now'|date('Y') }} <a href="https://www.technologin.fr" target="_blank">TechnoLogin</a> Tous droits
            réservés.
        </p>
    </div>
</footer>


</body>
</html>
